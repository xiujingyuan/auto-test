import{f as e,a1 as t,$ as a,l,t as n,a4 as i,M as o,F as s,m as r,a5 as d,D as c,ac as h,A as u,a6 as p,a7 as m,Q as g,d as f,ad as C,q as k,C as y,c as b}from"./@vue.160ddf67.js";import{d as w}from"./vuedraggable.03b46352.js";const x={emits:["value-change"],name:"edit-cell",components:{},props:{editIndex:{type:Number},editProp:{type:String},editValueMap:{type:Object,default:{}},editComponent:{type:String,default:function(){return"el-input"}},editComponentProps:{type:Object,default:function(){return{}}},editData:{type:String,default:function(){return""}}},data(){return{filter_list:[],real_data:this.tableData,isEdit:e(!1),boolMap:{true:!0,false:!1,1:!0,0:!1}}},computed:{monthAfter(){const e=new Date;let t=new Date,a=new Date,l=new Date,n=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();return t.setTime(e.getTime()-864e5),t=t.toLocaleDateString().replace(/\//g,"-"),a.setTime(e.getTime()+6048e5),a=a.toLocaleDateString().replace(/\//g,"-"),l.setTime(e.getTime()+864e5*n),l=l.toLocaleDateString().replace(/\//g,"-"),[{text:"今天",value:new Date},{text:"昨天",value:t},{text:"一周后",value:a},{text:"一月后",value:l}]}},methods:{valueChange(){"el-switch"==this.editComponent?this.$emit("value-change",this.editProp,this.editIndex,this.boolMap[this.editData].toString()):this.$emit("value-change",this.editProp,this.editIndex,this.editData)},changeData:e=>"true"==e,handleCellClick(e,t,a,l){console.log(e,t,a,l)},toDetail(e){VueEvent.$emit("toChildDetail",e)}}},_={class:"name-wrapper"};x.render=function(e,h,u,p,m,g){const f=t("el-input"),C=t("el-option"),k=t("el-select"),y=t("el-popover"),b=t("el-date-picker"),w=t("el-switch");return"el-input"==u.editComponent?(a(),l(f,{key:0,modelValue:u.editData,"onUpdate:modelValue":h[0]||(h[0]=e=>u.editData=e),size:"small",onChange:g.valueChange},null,8,["modelValue","onChange"])):"el-select"==u.editComponent?(a(),l(k,{key:1,modelValue:u.editData,"onUpdate:modelValue":h[1]||(h[1]=e=>u.editData=e),size:"small",onChange:g.valueChange},{default:n((()=>[(a(!0),i(s,null,o(u.editComponentProps.options,(e=>(a(),l(C,{key:e.text.value,label:e.text.text,value:e.text.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])):"el-popover"==u.editComponent?(a(),l(y,{key:2,effect:"light",trigger:"click",placement:"bottom",width:500},{default:n((()=>[r(f,{modelValue:u.editData,"onUpdate:modelValue":h[2]||(h[2]=e=>u.editData=e),onChange:g.valueChange,type:"textarea",rows:15},null,8,["modelValue","onChange"])])),reference:n((()=>[d("div",_,c(u.editComponentProps.showText),1)])),_:1})):"el-date-picker"==u.editComponent?(a(),l(b,{key:3,modelValue:u.editData,"onUpdate:modelValue":h[3]||(h[3]=e=>u.editData=e),onChange:g.valueChange,"value-format":"YYYY.MM.DD",type:u.editComponentProps.type,editable:!1,placeholder:"选择日期",format:u.editComponentProps.format,style:{width:"140px"},size:"small",shortcuts:g.monthAfter},null,8,["modelValue","onChange","type","format","shortcuts"])):"el-switch"==u.editComponent?(a(),l(w,{key:4,modelValue:m.boolMap[u.editData],"onUpdate:modelValue":h[4]||(h[4]=e=>m.boolMap[u.editData]=e),onChange:g.valueChange},null,8,["modelValue","onChange"])):(a(),l(f,{key:5,modelValue:u.editData,"onUpdate:modelValue":h[5]||(h[5]=e=>u.editData=e),onChange:g.valueChange,size:"small"},null,8,["modelValue","onChange"]))};const v={name:"ColumnSetting",components:{Draggable:w},emits:["checked-list-event","show-check-box","fixed-column"],props:{columnsList:Array},data(){let e=this.columnsList.map((e=>e.label));e.splice(-1,1);let[...t]=e;return{getDarkTheme:!1,checkAll:!1,selection:!0,checkList:e,defaultCheckList:t,drag:!1,isIndeterminate:!1}},computed:{},methods:{getColor:(e,t)=>e.fixed==t?"color:#2080f0":"",fixedColumn(e,t){this.$emit("fixed-column",e,t)},checkedListChange(e){let t=e.length;this.checkAll=t===this.defaultCheckList.length,this.isIndeterminate=t>0&&t<this.defaultCheckList.length,this.$emit("checked-list-event",this.checkList)},onCheckAll(e){this.checkList=e?this.defaultCheckList:[],this.checkAll=!0,this.$emit("checked-list-event",this.checkList)},onSelection(e){this.selection=e,this.$emit("show-check-box",e)},resetColumns(){this.checkList=this.defaultCheckList,this.checkAll=!0,this.isIndeterminate=!1,this.$emit("checked-list-event",this.checkList)},onChange(){},onStart(){this.drag=!0},draggableEnd(){this.drag=!1}}},D=e=>(p("data-v-7f75a1b8"),e=e(),m(),e),V=D((()=>d("i",{class:"el-icon-setting"},null,-1))),L={class:"el-table__header"},S=g("列展示"),P=g("勾选列"),q=g("重置"),z={class:"el-table__body"},E={key:0,class:"el-menu-item"},O=D((()=>d("span",{class:"menu-item-span span-move"},[d("i",{class:"el-icon-position"})],-1))),j={class:"menu-item-span"},A=["onClick"],$={class:"menu-item-span"},F=["onClick"];v.render=function(e,o,s,c,p,m){const g=t("el-tooltip"),f=t("el-button"),C=t("el-checkbox"),k=t("el-col"),y=t("el-row"),b=t("Draggable"),w=t("el-checkbox-group"),x=t("el-popover");return a(),l(x,{trigger:"click",width:240,placement:"bottom-end",class:"setting-popover"},{reference:n((()=>[r(f,{type:"text"},{default:n((()=>[r(g,{class:"box-item",effect:"dark",content:"列设置",placement:"top",trigger:"hover"},{default:n((()=>[V])),_:1})])),_:1})])),default:n((()=>[d("div",L,[r(y,{class:"setting-header-row"},{default:n((()=>[r(k,{span:8},{default:n((()=>[r(C,{class:"setting-header-checkbox",indeterminate:p.isIndeterminate,checked:p.checkAll,"onUpdate:checked":o[0]||(o[0]=e=>p.checkAll=e),onChange:m.onCheckAll},{default:n((()=>[S])),_:1},8,["indeterminate","checked","onChange"])])),_:1}),r(k,{span:8},{default:n((()=>[r(C,{class:"setting-header-checkbox",checked:p.selection,"onUpdate:checked":o[1]||(o[1]=e=>p.selection=e),onChange:m.onSelection},{default:n((()=>[P])),_:1},8,["checked","onChange"])])),_:1}),r(k,{span:8,style:{display:"grid"}},{default:n((()=>[r(f,{type:"text",size:"large",onClick:m.resetColumns},{default:n((()=>[q])),_:1},8,["onClick"])])),_:1})])),_:1})]),d("div",z,[r(w,{modelValue:p.checkList,"onUpdate:modelValue":o[3]||(o[3]=e=>p.checkList=e),onChange:m.checkedListChange},{default:n((()=>[r(b,{modelValue:s.columnsList,"onUpdate:modelValue":o[2]||(o[2]=e=>s.columnsList=e),animation:"300","item-key":"prop",onStart:m.onStart,onEnd:m.draggableEnd},{item:n((({element:e})=>["操作"!=e.label?(a(),i("div",E,[r(y,null,{default:n((()=>[r(k,{span:4},{default:n((()=>[O])),_:1}),r(k,{span:12},{default:n((()=>[(a(),l(C,{key:e.prop,label:e.label},null,8,["label"]))])),_:2},1024),r(k,{span:4},{default:n((()=>[d("span",j,[r(g,{class:"box-item",effect:"dark",content:"固定在左侧",placement:"top",trigger:"hover"},{default:n((()=>[d("i",{class:"el-icon-d-arrow-left cursor-pointer",style:h(m.getColor(e,"left")),onClick:t=>m.fixedColumn(e,"left")},null,12,A)])),_:2},1024)])])),_:2},1024),r(k,{span:4},{default:n((()=>[d("span",$,[r(g,{class:"box-item",effect:"dark",content:"固定在右侧",placement:"top",trigger:"hover"},{default:n((()=>[d("i",{class:"el-icon-d-arrow-right cursor-pointer",style:h(m.getColor(e,"right")),onClick:t=>m.fixedColumn(e,"right")},null,12,F)])),_:2},1024)])])),_:2},1024)])),_:2},1024)])):u("",!0)])),_:1},8,["modelValue","onStart","onEnd"])])),_:1},8,["modelValue","onChange"])])])),_:1})},v.__scopeId="data-v-7f75a1b8";const R={name:"common-dynamic-table",emits:["query-change","edit-change","click-events","row-check-all-event"],components:{editCell:x,ColumnSetting:v},props:{title:{type:String,default:""},changeValueList:{type:Object,default:function(){return{}}},maxHeight:{type:Number,default:function(){return 1e3}},tableData:{type:Array,default:function(){return[]}},tableHeader:{type:Array,default:function(){return[]}},editStatus:{type:Object,default:()=>({})},pageParams:{type:Object,default:function(){return{page:1,limit:5,total:0}}},pagination:{type:Boolean,default:!1},backendQuery:{type:Boolean,default:!1},queryParams:{type:Object,default:function(){return{page:1,limit:5,filter:[],sort:[]}}}},data(){return{filter_list:[],real_data:f(this.tableData),isEdit:e(!1),boolMap:{true:!0,false:!1,1:!0,0:!1},showCheck:!1,checkList:this.tableHeader.map((e=>e.label))}},computed:{isShowCol(){return e=>"操作"==e||this.checkList.indexOf(e)>=0}},methods:{changeOption(e){let t=[];return Object.keys(e).forEach((a=>{t.find((e=>e.value==a.type))||t.push({text:e[a],value:a})})),t},getFixed(e){return"操作"==e.label?this.checkList.length>0&&"right":e.fixed},checkedListChange(e){this.checkList=e},checkBoxChange(e){this.showCheck=e},setColumnFix(e,t){this.tableHeader.forEach(((a,l)=>{console.log(a,l,a.prop==e.prop),a.prop==e.prop&&(a.fixed==t?a.fixed=!1:a.fixed=t)}))},visibleColumn(e){let t=[];return e.forEach(((e,a,l)=>{e.visible&&t.push(e)})),t},valueChange(e,t,a){t in this.changeValueList||(this.changeValueList[t]={}),e in this.changeValueList[t]||(this.changeValueList[t][e]=""),this.changeValueList[t][e]=a,this.$emit("edit-change",this.changeValueList)},show_filter:(e,t)=>C(Object.values(e)).find((e=>e.value==t)).text,handleCellClick(e,t,a,l){},getRealData(e){let t=[],a="";[...this.real_data]=this.tableData;let l=0;if(!Array.isArray(e)){a=Object.getOwnPropertyNames(e)[0],t=C(e[a]);let l=this.filter_list.find((e=>e.name==a));l?l.value=t:this.filter_list.push({name:a,value:t})}this.backendQuery?this.queryParams.filter=this.filter_list:(this.filter_list.forEach((e=>{e.value.length>0?Object.values(this.real_data).forEach(((t,a)=>{-1==e.value.indexOf(t[e.name])&&this.real_data.splice(this.real_data.findIndex((e=>e===t)),1)})):l+=1})),l==this.filter_list.length&&(this.real_data=this.tableData))},toDetail(e){this.$emit("toChildDetail",e)},toFilterValue(e){let t=[];return Object.keys(e).forEach((a=>{t.find((e=>e.value==a.type))||t.push({text:e[a],value:a})})),t},handleSort(e){this.backendQuery&&(this.queryParams.sort=e,this.$emit("queryChange",this.queryParams))},handleRowClick(e){this.$emit("click-events",e)},rowCheckAllChange(e){this.$emit("row-check-all-event",e)},tableRowClass({row:e,rowIndex:t}){e.index=t},handleSizeChange(e){this.queryParams.limit=e,this.queryParams.page=1,this.$emit("queryChange",this.queryParams)},pageCurrentChange(e){this.queryParams.page=e,this.$emit("queryChange",this.queryParams)}}},H={class:"table-title"},T={slot:"content"},U=["onClick"],I={class:"name-wrapper"},M={key:5},B={key:8};R.render=function(e,h,p,m,f,C){const b=t("el-col"),w=t("ColumnSetting"),x=t("el-row"),_=t("el-table-column"),v=t("el-tooltip"),D=t("edit-cell"),V=t("el-tag"),L=t("el-input"),S=t("el-popover"),P=t("el-link"),q=t("el-option"),z=t("el-select"),E=t("el-table"),O=t("el-pagination");return a(),i(s,null,[r(x,null,{default:n((()=>[r(b,{span:1},{default:n((()=>[d("div",H,c(p.title),1)])),_:1}),r(b,{span:22}),r(b,{span:1,class:"setting-btn"},{default:n((()=>[d("div",null,[r(w,{columnsList:p.tableHeader,onCheckedListEvent:C.checkedListChange,onShowCheckBox:C.checkBoxChange,onFixedColumn:C.setColumnFix},null,8,["columnsList","onCheckedListEvent","onShowCheckBox","onFixedColumn"])])])),_:1})])),_:1}),r(x,null,{default:n((()=>[r(E,{data:f.real_data,size:"mini",border:"","highlight-current-row":"","fixed-header":"",ref:"multipleTable",stripe:"","header-cell-style":{background:"rgba(249,253,255,1)"},style:{width:"100%","min-height":"55vh"},resizable:!0,"row-style":{"font-size":"12px",color:"#212121"},"row-class-name":C.tableRowClass,onSelectionChange:C.rowCheckAllChange,onSortChange:C.handleSort,onCellClick:C.handleCellClick,onFilterChange:C.getRealData,onRowClick:C.handleRowClick},{default:n((()=>[f.showCheck?(a(),l(_,{key:0,style:{background:"#E6F7FF"},type:"selection",fixed:"left",width:"40"})):u("",!0),r(_,{type:"index",width:"50"}),(a(!0),i(s,null,o(p.tableHeader,((t,m)=>(a(),i(s,null,[C.isShowCol(t.label)?(a(),l(_,{key:m,prop:t.prop,fixed:C.getFixed(t),label:t.label,sortable:!!t.sortable,filters:t.filters?t.filters:null,"column-key":t.prop,"filtered-value":null,"filter-multiple":!!t.filters,width:t.minWidth,align:"center"},{default:n((u=>[t.slot?k(e.$slots,t.prop,{key:0,row:u.row,index:u.$index},void 0,!0):t.clickFun?(a(),l(v,{key:1,placement:"bottom"},{default:n((()=>[d("div",T,c(u.row[t.prop]),1),d("span",{style:{color:"#1890ff",cursor:"pointer"},onClick:[e=>C.toDetail(u.row),h[0]||(h[0]=y((()=>{}),["stop"]))]},c(u.row[t.prop]||"-"),9,U)])),_:2},1024)):t.edit&&p.editStatus[u.row.index]?(a(),l(D,{key:2,editData:u.row[t.prop],editProp:t.prop,editIndex:u.row.index,editComponent:t.editComponent,editComponentProps:t.editComponentProps,onValueChange:C.valueChange},null,8,["editData","editProp","editIndex","editComponent","editComponentProps","onValueChange"])):p.editStatus[u.row.index]||"el-switch"!=t.editComponent?p.editStatus[u.row.index]||"el-popover"!=t.editComponent?t.filters?(a(),i("span",M,c(C.show_filter(t.filters,u.row[t.prop])),1)):"el-link"==t.showComponent?(a(),l(P,{key:6,href:u.row[t.href_prop],target:"_blank",class:"buttonText",type:"primary",underline:!1},{default:n((()=>[g(c(u.row[t.prop]),1)])),_:2},1032,["href"])):"el-select"==t.showComponent?(a(),l(z,{key:7,modelValue:u.row[t.last_build_jenkins_job],"onUpdate:modelValue":e=>u.row[t.last_build_jenkins_job]=e,size:"small"},{default:n((()=>[(a(!0),i(s,null,o(u.row[t.prop],(e=>(a(),l(q,{key:e.value,label:e.text,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])):(a(),i("span",B,c(u.row[t.prop]||"-"),1)):(a(),l(S,{key:4,effect:"light",trigger:"click",placement:"bottom",ref_for:!0,ref:"popoverRef{{ scope.row.index }}",width:500},{default:n((()=>[r(L,{modelValue:u.row[t.prop],"onUpdate:modelValue":e=>u.row[t.prop]=e,type:"textarea",disabled:!p.editStatus[u.row.index],rows:15},null,8,["modelValue","onUpdate:modelValue","disabled"])])),reference:n((()=>[d("div",I,c(t.editComponentProps.showText),1)])),_:2},1536)):(a(),l(V,{key:3,type:"true"==u.row[t.prop]||"1"==u.row[t.prop]?"success":"danger","disable-transitions":""},{default:n((()=>[g(c(t.editValueMap[u.row[t.prop]]),1)])),_:2},1032,["type"]))])),_:2},1032,["prop","fixed","label","sortable","filters","column-key","filter-multiple","width"])):u("",!0)],64)))),256))])),_:3},8,["data","header-cell-style","row-class-name","onSelectionChange","onSortChange","onCellClick","onFilterChange","onRowClick"]),p.pagination?(a(),l(O,{key:0,class:"table-box-pagination",onSizeChange:C.handleSizeChange,onCurrentChange:C.pageCurrentChange,"current-page":p.pageParams.page,"page-sizes":[5,10,20,30,50,100],"page-size":p.pageParams.limit,layout:"total, sizes, prev, pager, next, jumper",total:p.pageParams.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])):u("",!0)])),_:3})],64)},R.__scopeId="data-v-bf09843c";var Q={name:"RowEditTable",components:{CommonDynamicTable:R},emits:["edit-row","del-row","exec-row","save-row"],props:{tableData:{type:Array},tableHeader:{type:Array},pageParams:{type:Object},queryParams:{type:Object},maxHeight:{type:Number},execRowBtn:{type:Boolean,default:!1}},data(){const e=b((()=>(null!=this.tableHeader&&this.tableHeader.forEach(((e,t)=>{e.filters&&(e.filters=this.changeOptionList(e.filters),e.editComponentProps.options=this.changeOptionList(e.filters))})),this.tableHeader))),t=b((()=>{let e={};return null!=this.tableData&&this.tableData.forEach(((t,a)=>{e[a+1]=!1})),e}));return{reFlush:new Date,editStatus:t,convertTableHeader:e,changeValueList:{}}},methods:{changeOptionList(e){let t=[];return Object.keys(e).forEach((a=>{t.find((e=>e.value==a.type))||t.push({text:e[a],value:a})})),t},download(e){console.log(e)},editCancel(e){this.editStatus[e.index]=!1,e.isSelected=!1},editProcess(e){this.editStatus[e.index]=!0,e.isSelected=!0},delRow(e){this.$emit("del-row",e)},execRow(e){this.$emit("exec-row",e)},editSave(e){this.editStatus[e.index]=!1,e.isSelected=!1,e.index in this.changeValueList&&Object.keys(this.changeValueList[e.index]).forEach(((t,a)=>{this.tableData[e.index][t]=this.changeValueList[e.index][t]})),this.$emit("save-row",e)},editChange(e){this.changeValueList=e},checkedListChange(e){console.log("checkedListChange",e)},rowCheckAllChange(e){this.batchResendParams=e},queryChange(e){this.queryParams.sort.hasOwnProperty("prop")&&(this.reFlush=new Date,this.tableData=[{type:"after_loan_manage",send_time:"2020.11.20",receive_email:"tetwet_query",email_status_str:"2",order_no:"4234234234234",company:"testsetwet",send_order_status:"true",send_official_status:"tete"},{type:"consult",send_time:"2021.05.21",receive_email:"tetwet2_query",email_status_str:"1",order_no:"42342342342345",company:"testsetwet4",send_order_status:"false",send_official_status:"tete3"}])}},computed:{}};const Y=g("下载"),N=g("编辑"),W=g("删除"),G=g("执行"),J=g("保存"),K=g("取消");Q.render=function(e,o,d,c,h,p){const m=t("el-button"),g=t("CommonDynamicTable");return a(),i("div",null,[(a(),l(g,{tableData:e.tableData,tableHeader:e.convertTableHeader,pageParams:e.pageParams,backendQuery:!1,key:e.reFlush,editStatus:e.editStatus,queryParams:e.queryParams,"max-height":e.maxHeight,onQueryChange:e.queryChange,onEditChange:e.editChange},{download:n((t=>[r(m,{onClick:y((a=>e.download(t.row)),["stop"]),type:"text",size:"small"},{default:n((()=>[Y])),_:2},1032,["onClick"])])),btn:n((t=>[e.editStatus[t.row.index]?(a(),i(s,{key:1},[r(m,{size:"small",type:"text",onClick:y((a=>e.editSave(t.row)),["stop"])},{default:n((()=>[J])),_:2},1032,["onClick"]),r(m,{onClick:y((a=>e.editCancel(t.row)),["stop"]),type:"text",size:"small"},{default:n((()=>[K])),_:2},1032,["onClick"])],64)):(a(),i(s,{key:0},[r(m,{size:"small",type:"text",onClick:y((a=>e.editProcess(t.row)),["stop"])},{default:n((()=>[N])),_:2},1032,["onClick"]),r(m,{size:"small",type:"text",onClick:y((a=>e.delRow(t.row)),["stop"])},{default:n((()=>[W])),_:2},1032,["onClick"]),e.execRowBtn?(a(),l(m,{key:0,size:"small",type:"text",onClick:y((a=>e.execRow(t.row)),["stop"])},{default:n((()=>[G])),_:2},1032,["onClick"])):u("",!0)],64))])),_:1},8,["tableData","tableHeader","pageParams","editStatus","queryParams","max-height","onQueryChange","onEditChange"]))])};export{Q as _};
